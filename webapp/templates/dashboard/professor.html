{% extends 'base.html' %} {% block title %}Professor Dashboard{% endblock %} {%
block extra_css %}
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/dashboard/professor_dash.css') }}"
/>
{% endblock %} {% block content %}
<div class="dashboard-section">
  <h1>Welcome, Professor {{ current_user.name }}!</h1>
  <p>This is your dashboard where you can manage your courses and students.</p>
</div>
<section>
  <h2>Enrollments to your course</h2>
  {% if enrollments %}
  <table border="1" cellpadding="8">
    <thead>
      <tr>
        <th>Student</th>
        <th>Course</th>
        <th>Score</th>
        <th>Letter Grade</th>
        <th>Date Enrolled</th>
      </tr>
    </thead>
    <tbody>
      {% for enrollment in enrollments %}
      <tr>
        <td>{{ enrollment.student.name }}</td>
        <td>{{ enrollment.course.name }}</td>
        <td>{{ enrollment.score or 'N/A' }}</td>
        <td>{{ enrollment.letter_grade or 'N/A' }}</td>
        <td>
          {{ enrollment.date_enrolled.strftime('%Y-%m-%d') if
          enrollment.date_enrolled else 'N/A' }}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <div class="grades">
    {% for enrollment in enrollments %} {% if enrollment.score is none %}
    <p>
      {{ enrollment.student.name }} has not been graded yet for {{
      enrollment.course.name }}.
    </p>
    <button id="grade-student">Grade Student</button>
    <!--Grade student modal-->
    <dialog id="modal" class="modal">
      <div class="modal-content">
        <h2>This will grade {{ enrollment.student.name }}</h2>
        <div>
          <form action="#" class="active">
            <label for="score">
              Enter the score
              <input type="number" name="score" id="score" />
            </label>
            <label for="letter-grade">
              Enter the letter grade
              <input type="text" name="letter-grade" id="letter-grade" />
            </label>
            <div class="button-row">
              <button class="action-btn delete close-modal" type="button">
                Cancel
              </button>
              <button class="action-btn view close-modal" type="submit">
                Submit
              </button>
            </div>
          </form>
        </div>
      </div>
    </dialog>
    {% endif %} {% endfor %}
  </div>
  {% else %}
  <p>No enrollments found.</p>
  {% endif %}
</section>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const gradeButton = document
      .getElementById("grade-student")
      .addEventListener("click", openActionMenu);
    const modal = document.getElementById("modal");
    const closeModalBtn = document
      .querySelectorAll(".close-modal")
      .forEach((btn) =>
        btn.addEventListener("click", () => {
          console.log("clicked to close");

          modal.close();
        })
      );

    function openActionMenu() {
      modal.showModal();
    }

    function addGrade() {}
  });
</script>
{% endblock %}
